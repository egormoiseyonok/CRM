# Система прав доступа CRM

## Роли пользователей

### 1. Администратор (admin)
**Полные права на все операции**

#### Управление пользователями
- ✅ Просмотр всех пользователей
- ✅ Создание новых пользователей (любых ролей)
- ✅ Редактирование пользователей
- ✅ Удаление пользователей
- ✅ Назначение ролей (admin, manager, user)
- ✅ Просмотр статистики по всем пользователям

#### Компании
- ✅ Просмотр всех компаний
- ✅ Создание компаний
- ✅ Редактирование любых компаний
- ✅ Удаление компаний
- ✅ Экспорт всех данных

#### Контакты
- ✅ Просмотр всех контактов
- ✅ Создание контактов
- ✅ Редактирование любых контактов
- ✅ Удаление контактов

#### Сделки
- ✅ Просмотр всех сделок
- ✅ Создание сделок
- ✅ Редактирование любых сделок
- ✅ Удаление сделок
- ✅ Изменение этапов сделок
- ✅ Просмотр финансовой информации

#### Задачи
- ✅ Просмотр всех задач
- ✅ Создание задач
- ✅ Редактирование любых задач
- ✅ Удаление задач
- ✅ Назначение задач любым пользователям

#### Отчёты и аналитика
- ✅ Доступ ко всем отчётам
- ✅ Экспорт всех данных
- ✅ Просмотр статистики по всем пользователям
- ✅ Финансовые отчёты

#### Активности
- ✅ Просмотр всех активностей
- ✅ Создание активностей
- ✅ Удаление активностей

---

### 2. Менеджер (manager)
**Права на управление данными, но без удаления и управления пользователями**

#### Управление пользователями
- ❌ Не может управлять пользователями
- ✅ Просмотр списка пользователей (только для назначения задач/сделок)

#### Компании
- ✅ Просмотр всех компаний
- ✅ Создание компаний
- ✅ Редактирование любых компаний
- ❌ Удаление компаний (только администратор)
- ✅ Экспорт данных компаний

#### Контакты
- ✅ Просмотр всех контактов
- ✅ Создание контактов
- ✅ Редактирование любых контактов
- ❌ Удаление контактов (только администратор)

#### Сделки
- ✅ Просмотр всех сделок
- ✅ Создание сделок
- ✅ Редактирование любых сделок
- ❌ Удаление сделок (только администратор)
- ✅ Изменение этапов сделок
- ✅ Просмотр финансовой информации
- ✅ Закрытие сделок (won/lost)

#### Задачи
- ✅ Просмотр всех задач
- ✅ Создание задач
- ✅ Редактирование любых задач
- ❌ Удаление задач (только администратор)
- ✅ Назначение задач любым пользователям
- ✅ Завершение задач

#### Отчёты и аналитика
- ✅ Доступ к отчётам
- ✅ Экспорт данных
- ✅ Просмотр статистики
- ✅ Финансовые отчёты

#### Активности
- ✅ Просмотр всех активностей
- ✅ Создание активностей
- ❌ Удаление активностей (только администратор)

---

### 3. Пользователь (user)
**Ограниченные права, работа только со своими данными**

#### Управление пользователями
- ❌ Не может управлять пользователями
- ✅ Просмотр своего профиля
- ✅ Редактирование своего профиля (имя, email, пароль)

#### Компании
- ✅ Просмотр только своих компаний
- ✅ Создание компаний (присваиваются себе)
- ✅ Редактирование только своих компаний
- ❌ Удаление компаний
- ✅ Экспорт своих данных

#### Контакты
- ✅ Просмотр только своих контактов
- ✅ Создание контактов (присваиваются себе)
- ✅ Редактирование только своих контактов
- ❌ Удаление контактов

#### Сделки
- ✅ Просмотр только своих сделок
- ✅ Создание сделок (присваиваются себе)
- ✅ Редактирование только своих сделок
- ❌ Удаление сделок
- ✅ Изменение этапов своих сделок
- ✅ Просмотр финансовой информации только своих сделок

#### Задачи
- ✅ Просмотр только своих задач
- ✅ Создание задач (присваиваются себе)
- ✅ Редактирование только своих задач
- ❌ Удаление задач
- ❌ Назначение задач другим пользователям
- ✅ Завершение своих задач

#### Отчёты и аналитика
- ❌ Нет доступа к отчётам (только для admin/manager)
- ✅ Экспорт только своих данных

#### Активности
- ✅ Просмотр только своих активностей
- ✅ Создание активностей
- ❌ Удаление активностей

---

## Сводная таблица прав

| Действие | Администратор | Менеджер | Пользователь |
|----------|--------------|----------|--------------|
| Управление пользователями | ✅ | ❌ | ❌ |
| Создание компаний | ✅ | ✅ | ✅ (только свои) |
| Редактирование компаний | ✅ (все) | ✅ (все) | ✅ (только свои) |
| Удаление компаний | ✅ | ❌ | ❌ |
| Создание сделок | ✅ | ✅ | ✅ (только свои) |
| Редактирование сделок | ✅ (все) | ✅ (все) | ✅ (только свои) |
| Удаление сделок | ✅ | ❌ | ❌ |
| Просмотр всех данных | ✅ | ✅ | ❌ |
| Доступ к отчётам | ✅ | ✅ | ❌ |
| Экспорт всех данных | ✅ | ✅ | ❌ (только свои) |
| Удаление любых записей | ✅ | ❌ | ❌ |

---

## Примечания

1. **Автоматическое присвоение**: При создании записи обычным пользователем, она автоматически присваивается ему (user_id)
2. **Фильтрация данных**: Обычные пользователи видят только свои данные в списках
3. **Проверка прав**: Все операции проверяются на сервере перед выполнением
4. **UI ограничения**: Интерфейс скрывает недоступные функции для пользователей без прав

